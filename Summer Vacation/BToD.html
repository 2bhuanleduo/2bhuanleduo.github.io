<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>二进制转十进制</title>
    </head>

    <body>
        <table cellspacing="14">
            <tr>
                <td>二进制数</td>
                <td><input type="number" id="Binary" value=0></td>
            </tr>
        </table>    

        <button type="button" onclick="BToD()">转换</button>

        <script type="text/javascript">

            var before_dot,after_dot;   //分别用来存储整数和小数部分的值

            var str,result;            //str用来存储输入的数字 字符串

            var number=0;
            var after_number;       //用来存储小数点后位数
            var before_number;      //用来存储整数位数

            var before=new Array();         //用来存储整数部分的各数值
            var after=new Array();          //用来存储小数部分的各数值


            function BToD()
            {
                alert("结果在console中");
                var binary=document.getElementById("Binary").value;

                str=binary.split(".");
                
                before_dot=parseInt(str[0]);

                after_dot=parseInt(str[1]);

                after_number=GetNumber(after_dot);
                
                //如果直接用数值相减来计算，小数部分会出现很多多余的数值

                for(var j=0;j<after_number;j++)
                {
                    after_dot=parseFloat(after_dot/10);     //将分离后的after_dot变成小数
                }

                after_dot=after_dot.toFixed(after_number);

                Integer(before_dot);
                Decimal(after_dot);

                {
                var numb=0,numa=0;

                for(var i=0;i<before_number;i++)
                {
                    numb=numb+before[i]*Math.pow(2,i);
                }

                for(var j=1;j<=after_number;j++)
                {
                    numa=numa+after[after_number-j]*Math.pow(2,-j);
                }

                result=numa+numb;

                console.log(result);
                
                }
            }

            //用来分离整数部分的数值
            function Integer(num)
            {
                before_number=GetNumber(before_dot);

                for(var j=0;j<before_number;j++)
                {
                    before[j]=num%10;
                    num=parseInt(num/10);
                }
            }

            function Decimal(num)
            {
                var num2=parseInt(str[1]);

                for(var i=0;i<after_number;i++)
                {
                    after[i]=num2%10;
                    num2=parseInt(num2/10);
                }
            }
            
            function GetNumber(data)
            {

                for(var i=0;i<40;i++)
                {
                    var data=data/10;
                    number++;

                    if(parseInt(data)==0)
                    {
                        break;
                    }
                
                }
                return number;

                number=1;
            }

        </script>


    </body>
</html>
